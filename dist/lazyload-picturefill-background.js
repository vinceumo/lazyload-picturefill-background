(function () {var a={};function c(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function b(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function d(e,r,t){return r&&b(e.prototype,r),t&&b(e,t),e}var e=function(){function e(r){c(this,e),this.options=e.updateDefaultSettings(r),this.init()}return d(e,[{key:"init",value:function(){var e=this;this.options.pictureFillBackgroundSelector.length&&Array.prototype.forEach.call(this.options.pictureFillBackgroundSelector,function(r){var t=[],a=[],n=r.querySelectorAll(e.options.pictureFillBackgroundSourceSelector);t=e.getSources(n);var o=!0,c=!1,i=void 0;try{for(var l,u=function(){var t=l.value,n=window.matchMedia(t.media);window.matchMedia&&n.matches&&a.push(t.src),n.addListener(function(){n.matches&&(new RegExp(e.escapeRegExp(t.src)).test(r.style.backgroundImage)||(r.style.backgroundImage="url('"+t.src+"')"))})},s=t[Symbol.iterator]();!(o=(l=s.next()).done);o=!0)u()}catch(f){c=!0,i=f}finally{try{o||null==s.return||s.return()}finally{if(c)throw i}}if(r.classList.contains(e.options.lazySelector.substring(1)))createObserver(r,a);else{var p=a.length?a.pop():t[0];r.style.backgroundImage="url('"+p+"')"}})}},{key:"getSources",value:function(e){var r=[];return Array.prototype.forEach.call(e,function(e){var t={src:e.getAttribute("data-src"),media:e.getAttribute("data-media")};r.push(t)}),r}},{key:"createObserver",value:function(e,r){new IntersectionObserver(function(e){e.forEach(function(e){if(e.isIntersecting){var t=e.target;t.classList.remove(this.options.lazySelector.substring(1)),this.lazyBackgroundImageObserver.unobserve(t);var a=r.length?r.pop():matches[0];t.style.backgroundImage="url('"+a+"')"}})}).observe(e)}},{key:"escapeRegExp",value:function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}],[{key:"updateDefaultSettings",value:function(e){var r={pictureFillBackgroundSelector:".picturefill-background",lazySelector:"is-lazy",pictureFillBackgroundSourceSelector:".picturefill-background-source"};for(var t in e)r[t]=e[t];return r.pictureFillBackgroundSelector="string"==typeof r.pictureFillBackgroundSelector?document.querySelectorAll(r.pictureFillBackgroundSelector):r.pictureFillBackgroundSelector,r}}]),e}();a.default=e;if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=a}else if(typeof define==="function"&&define.amd){define(function(){return a})}})();